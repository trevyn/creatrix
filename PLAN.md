"What needs to be done immediately before this step is achieved?"

Make a Turbopilot. It provides AI-generated text completions while coding. It does this by understanding the current plan and the text editing context.

Make slightly more nicely formatted suggestions.

Thin separation line between suggestions.

Instead of one big <pre> tag, use a series of <div> tags.

Instead of element.textContent, use element.innerHTML

We have to encode the HTML entity characters with  for safety.